(window.webpackJsonp=window.webpackJsonp||[]).push([[81],{143:function(e,t,r){"use strict";var n=r(144),o=r.n(n);t.default=o.a},144:function(e,t){e.exports={name:"VueHcaptcha",props:{sitekey:{type:String,required:!0},theme:{type:String},size:{type:String},tabindex:{type:String}},mounted:function(){if(void 0===window.hcaptcha){var script=function(e){var script=document.createElement("script");return script.src="https://hcaptcha.com/1/api.js?render=explicit",script.async=!0,script.addEventListener("load",e,!0),script}(this.onloadScript),e=document.getElementById("hcap-script");document.getElementsByTagName("head").length>0&&(e=document.getElementsByTagName("head")[0]),e.appendChild(script)}else this.onloadScript()},methods:{onloadScript:function(){var e={sitekey:this.sitekey,theme:this.theme?this.theme:"",size:this.size?this.size:"",tabindex:this.tabindex?this.tabindex:"",callback:this.onVerify,"expired-callback":this.onExpired,"error-callback":this.onError};if(void 0!==window.hcaptcha){var t=window.hcaptcha,r=this.$slots.default?this.$el.children[0]:this.$el;this.$widgetId=t.render(r,e)}},onError:function(e){"undefined"!==window.hcaptcha&&(this.$emit("error",e),this.reset())},onVerify:function(e){this.$emit("verify",e)},onExpired:function(){this.$emit("expired")},execute:function(){window.hcaptcha.execute(this.$widgetId)},reset:function(){window.hcaptcha.reset(this.$widgetId)}}}},293:function(e,t,r){"use strict";(function(e){var n=r(294);const o={install:function e(t){e.installed||(e.installed=!0,t.component("vuehcaptcha",n.default))}};let c=null;"undefined"!=typeof window?c=window.Vue:void 0!==e&&(c=e.Vue),c&&c.use(o),t.a=n.default}).call(this,r(12))},294:function(e,t,r){"use strict";var n=r(298),o=r(143),c=r(10),component=Object(c.a)(o.default,n.a,n.b,!1,null,null,null);t.default=component.exports},298:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}));var n=function(){var e=this.$createElement;this._self._c;return this._m(0)},o=[function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("div",{attrs:{id:"hcap-script"}})])}]},595:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _hcaptcha_vue_hcaptcha__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(293),_scripts_utils__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createForOfIteratorHelper(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,l=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return c=e.done,e},e:function(e){l=!0,o=e},f:function(){try{c||null==r.return||r.return()}finally{if(l)throw o}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}var i18nPrefix="routes.survey.";__webpack_exports__.default={name:"Survey",head:function(){return this.$store.set("hero",{title:i18nPrefix+"hero.title",subtitle:i18nPrefix+"hero.subtitle"}),{title:this.$t(i18nPrefix+"title")}},beforeRouteEnter:function(e,t,r){var n=this;r((function(e){e.$store.get("survey")&&0!==e.$store.get("survey").length||e.$router.push(n.localePath({name:"Home"}))}))},data:function(){return this.$store.commit("RESTORE_HERO"),{i18nPrefix:i18nPrefix,result:{},errors:{},loading:!1}},computed:{survey:function(){var e,t={survey:this.$store.get("survey")&&this.$store.get("survey").length?this.$store.get("survey@[0].survey.questions"):[],result:{}},r=_createForOfIteratorHelper(t.survey);try{for(r.s();!(e=r.n()).done;){var n=e.value;if(this.$data.errors[n.name]=!1,"checkbox"===n.type)t.result[n.name]=[];else if("matrix"===n.type){t.result[n.name]={};var o,c=_createForOfIteratorHelper(n.rows);try{for(c.s();!(o=c.n()).done;){var l=o.value;t.result[n.name][l.value]=null}}catch(e){c.e(e)}finally{c.f()}}else["html"].indexOf(n.type)<0&&(t.result[n.name]=null)}}catch(e){r.e(e)}finally{r.f()}return this.$data.result=t.result,t.survey},sitekey:function(){return"6Le0qqAUAAAAADcXlFuBa9hfCXfdUi53i85sWzSp"}},methods:{getSurveyLocal:function(e){return this.$store.get("locale")in e?e[this.$store.get("locale")]:e.default},getConstraint:function(e,t){return e.validators.filter((function(e){return t in e})).map((function(e){return e[t]}))[0]},checkCondition:function checkCondition(question){var _this2=this,r;if(!question.visibleIf)return!0;var simpleExpression=/{(\w+)}\s*=\s*('?\w+'?)/,containsExpression=/{(\w+)}\s*contains\s*"?'?(\w+)'?"?/,customExpression=/\{([^{]+)\}/g;return simpleExpression.test(question.visibleIf)?(r=simpleExpression.exec(question.visibleIf),eval("".concat(this.$data.result[r[1]],"===").concat(r[2]))):containsExpression.test(question.visibleIf)?(r=containsExpression.exec(question.visibleIf),this.$data.result[r[1]]&&this.$data.result[r[1]].indexOf(r[2])>=0):eval(question.visibleIf.replace(customExpression,(function(e,text){return _this2.$data.result[text]?"'".concat(_this2.$data.result[text].replace(/\n/gm,""),"'"):"''"})))},callback:function(e){var t=this;this.$axios.post("https://api.foe.tools/surveyresponses",{response:{response:this.$data.result,survey:this.$store.get("survey@[0].id")},captcha:e}).then((function(){t.$data.loading=!1,t.complete({message:t.$t(i18nPrefix+"survey_complete"),type:"is-success",indefinite:!0})})).catch((function(e){t.$data.loading=!1,400===e.response.status?t.$buefy.notification.open({message:t.$t(i18nPrefix+"error"),type:"is-danger",indefinite:!0}):t.$buefy.notification.open({message:t.$t(i18nPrefix+"unknown_error"),type:"is-danger",indefinite:!0}),console.error("error: ",e)}))},prepare:function(){var e=this,t=this.$refs.formSurvey.reportValidity();if(!t)return!1;var r,n=_createForOfIteratorHelper(this.survey);try{for(n.s();!(r=n.n()).done;){var o=r.value;this.$data.errors[o.name]=!1}}catch(e){n.e(e)}finally{n.f()}var c=function(r){var n=e.survey.find((function(e){return e.name===r}));if(e.$data.result[r]instanceof Array&&n.isRequired&&e.checkCondition(n)&&0===e.$data.result[r].length||e.survey.find((function(e){return e.name===r})).isRequired&&e.checkCondition(n)&&null===e.$data.result[r])e.$data.errors[r]=!0,t=!1;else if("object"===_typeof(e.$data.result[r])&&n.isRequired&&e.checkCondition(n))for(var o in e.$data.result[r])if(null===e.$data.result[r][o]){e.$data.errors[r]=!0,t=!1;break}};for(var l in this.$data.result)c(l);return this.$forceUpdate(),!!t&&(this.$data.loading=!0,!0)},getErrorMessage:function(e){return e.isRequired&&this.$data.errors[e.name]?this.$t(i18nPrefix+"required_field"):""},complete:function(e){var t=this.$cookies.get("survey");t||(t=[]),t.push(this.$store.get("survey@[0].id")),this.$cookies.set("survey",t,{path:"/",expires:_scripts_utils__WEBPACK_IMPORTED_MODULE_1__.a.getDefaultCookieExpireTime()}),this.$buefy.notification.open(e),this.$router.push(this.localePath({name:"Home"})),this.$store.dispatch("nuxtServerInit")},onExpire:function(){this.$refs.invisibleHcaptcha.reset()},onSubmit:function(){this.prepare()&&this.$refs.invisibleHcaptcha.execute()}},components:{VueHcaptcha:_hcaptcha_vue_hcaptcha__WEBPACK_IMPORTED_MODULE_0__.a}}}}]);